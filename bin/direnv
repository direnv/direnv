#!/bin/sh
#
# git-like libexec switcher

set -e

usage() {
  echo "direnv export|exec|switch [options]" >&2
}

realpath() {
  local path=`readlink $1`

  if [ -z $path ]; then
    echo $1
  else
    if [[ $path = /* ]]; then
      echo $path
    else
      echo $(realpath "$PWD/${path#./}")
    fi
  fi
}

binpath=$(realpath $0)
bindir=`dirname "$binpath"`

if [ -z "$1" ]; then
  usage
  exit 1
fi

prefix="$bindir/direnv-"

if ! [ -x "$prefix$1" ]; then
  prefix="direnv-"
fi

exec $prefix$@
